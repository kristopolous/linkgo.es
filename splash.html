<!doctype html5>
<link href='http://fonts.googleapis.com/css?family=Donegal+One' rel='stylesheet' type='text/css'>
<title>ThisWillTake.Me</title>
<style>
body { 
  background: url('img/textured_paper.png');
  margin: 0;
  text-align: center;
  font-family: 'Donegal One', serif;
}
h1 { 
  margin-top: 1.5em;
  color: #102314;
  margin-bottom: 0.25em;
  font-size: 3.5em;
  letter-spacing: 0.1em;
  text-shadow: 2px 2px 1px rgba(30, 60, 40, 0.5);
}
h2 {
  color: #081510;
}
p {
  font-size:1.25em;
  margin-bottom: 1.25em;
  margin-top: 0;
}

button,input {
  display: block;
  font-family: 'Donegal One', serif;
  font-size:1.5em;
}
button { 
  float: right;
}
input {
  padding: 0.2em;
  border-radius: 8px;
}

.active > #loader { display: inline-block; padding:0.58em 0 ;width:80px;}
#loader           { display: none; }

.active > #doTransform { display: none; }

#transform{
  text-align: center;
  width: 280px;
  display: block;
  margin-top: 0.5em; 
  float: right;
}
input {
  width: 25em;
}
#linkContainer {
  display: none;
  padding: 0;
  top: 0;
  margin: 0;
  left: 0;
  color: #d0f4d8;
  width: 100%;
  font-size: 1.25em;
}
#link {
  font-size: 0.9em;
  padding: 0.75em 0 0.5em;
  background: rgba(16, 35, 20, 0.8);
  margin:0;
}
#clipboard-wrapper:hover {
  background: rgba(78, 140, 80, 0.5);
  color: #243;
}
#clipboard-wrapper:active {
  background: rgba(32, 65, 40, 0.6);
  color:#fff;
}
#clipboard-wrapper {
  font-weight: bold;
  padding: 0.25em 0;
  text-decoration: underline;
  background: rgba(78, 130, 80, 0.7);
  color:#fff;
  cursor: pointer;
}
#main {
  margin-top: 1em;
  border: 2px solid rgba(16, 35, 20, 0.3);
  box-shadow: 0px 0px 3px 4px rgba(230, 250, 240, 0.5);
  border-radius: 10px;
  background: rgba(160, 190, 150, 0.45);
  padding: 1.5em;
  display: inline-block;
}
</style>
<div id="linkContainer">
  <p id="link">http://www.youtube.com/watch?v=vWiCqUD-uJo</p>
  <div id=clipboard-wrapper>
    <a onclick=clipboard() id=clipboard-button class=btn>Copy to Clipboard</a>
  </div>
</div>
<h1>ThisWillTake.Me</h1>
<h2>Demystifies URLs.</h2>

<div id="main">
  <p>Drop a link below (try youtube or a news site).</p>
  <input id="url" type="text" placeholder="http://example.com/" autocomplete="off" value="">
  <span id='transform'>
    <img id="loader" src="img/ajax-loader.gif">
    <button id="doTransform" onclick=doTransform()>Make it descriptive!</button>
  </span>
</div>

<script src=jquery-1.9.1.min.js></script>
<script>
var clip;
$(function(){
  $("#url").focus();
});
function doTransform(){
  var url = $("#url").val();
  if(url.length) {
    $("#linkContainer").css({
      display: 'none'
    });
    $("#transform").addClass("active");
    $.post("/", {url: url}, function(ret) {
      $("#transform").removeClass("active");
      if(ret.status) {
        $("#url").val("");
        $("#link").html(ret.url);
        $("#linkContainer").slideDown(1000, function(){
          initClipboard();
        });
        $("#url").focus();
      }
    }, 'json');
  }
}

function initClipboard() {
  clip = new ZeroClipboard.Client();
  ZeroClipboard.setMoviePath("ZeroClipboard.swf")
  clip.setHandCursor( true );
  clip.addEventListener('mouseOver', function (client) {
    // update the text on mouse over
    clip.setText($("#link").html());  
  });
  clip.addEventListener('complete', function (client, text) {
    console.log("Copied text to clipboard: " + text );
    /*
    $("#clipboard-notice").css('display','block').animate({
      height: "60px"
    });
    setTimeout(function(){
      $("#clipboard-notice").animate({
        height: "0"
      }, function(){
        this.style.display = 'none';
      });
    }, 8000);
    */
  });

  clip.glue( 'clipboard-button', 'clipboard-wrapper' );
  $("#ZeroClipboardMovie_1").css('opacity',0.001);
}
function clipboard(){
  clip.setText($("#link").html());  
}
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-28399789-3']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
<script src=ZeroClipboard.min.js></script>
